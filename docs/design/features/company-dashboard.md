# 기업 대시보드 기능 명세

> 참조: `durubitteo_design/src/CompanyDashboard.jsx`

## 개요

기업 인사담당자가 사용하는 근로자 관리 시스템. 출퇴근 현황 확인, 근로자 등록/관리, 근무일정 등록, 공지사항 발송 기능 제공.

---

## 구현 상태

**구현 완료** (라우트 기반 탭 구조)

### 라우트 구조

```
/app/company/
├── layout.tsx              # 헤더 + 4개 탭 네비게이션 (Link 기반)
├── page.tsx                # → /company/dashboard 리다이렉트
├── _components/            # 공용 컴포넌트
├── _data/                  # 더미 데이터
├── dashboard/page.tsx      # 대시보드 탭
├── employees/
│   ├── page.tsx            # 근로자 관리 탭 (목록)
│   └── [id]/page.tsx       # 근로자 상세 페이지
├── schedule/page.tsx       # 근무일정 탭
└── notices/page.tsx        # 공지사항 탭
```

### URL 구조

| URL | 설명 |
|-----|------|
| `/company` | `/company/dashboard`로 리다이렉트 |
| `/company/dashboard` | 대시보드 탭 |
| `/company/employees` | 근로자 관리 탭 (목록) |
| `/company/employees/:id` | 근로자 상세 페이지 |
| `/company/schedule` | 근무일정 탭 |
| `/company/notices` | 공지사항 탭 |

---

## 탭 구성

| 탭 ID | 탭 이름 | 아이콘 | 설명 |
|-------|--------|--------|------|
| dashboard | 대시보드 | TrendingUp | 통계 카드 및 출퇴근 기록 조회 |
| employees | 근로자 관리 | Users | 근로자 목록 조회 및 등록 |
| attendance | 근무일정관리 | Clock | 캘린더 기반 근무 내용 등록 |
| notices | 공지사항 | MessageSquare | 근로자에게 공지 발송 |

---

## 탭별 상세 기능

### 1. 대시보드 탭

**목적**: 오늘의 출퇴근 현황 한눈에 파악

#### 통계 카드 (4열)
| 카드 | 아이콘 | 색상 | 데이터 |
|------|--------|------|--------|
| 전체 근로자 | Users | 파란색 | {총원}명 |
| 출근 | UserCheck | 주황색 (강조) | {출근}명 |
| 퇴근 | Clock | 회색 | {퇴근}명 |
| 출근율 | TrendingUp | 녹색 | {출근율}% |

#### 출퇴근 기록 테이블

**날짜 선택**:
- 이전/다음 날짜 버튼
- 현재 선택 날짜 표시 (예: "2026년 1월 28일 (화)")

**테이블 컬럼**:
| 컬럼 | 설명 |
|------|------|
| 이름 | 근로자 이름 (아바타 포함) |
| 전화번호 | 연락처 |
| 출근 | 출근 시간 (미출근 시 "-") |
| 퇴근 | 퇴근 시간 (미퇴근 시 "-") |
| 상태 | 출근 완료 / 퇴근 완료 / 결근 / 출근 전 |
| 업무 내용 | 퇴근 시 입력한 내용 |

**상태 배지 색상**:
- 출근 완료: 주황색 배경
- 퇴근 완료: 회색 배경
- 결근: 빨간색 배경
- 출근 전: 노란색 배경

---

### 2. 근로자 관리 탭

**목적**: 소속 근로자 목록 조회 및 신규 등록
**API 연동**: ✅ 완료 (`GET /v1/employees`)

#### 상단 영역
- "근로자 관리" 제목
- 검색창 (이름, 전화번호 클라이언트 필터링)
- "+ 근로자 추가" 버튼

#### 근로자 목록 테이블
| 컬럼 | 설명 |
|------|------|
| 이름 | 아바타(이니셜) + 이름 |
| 전화번호 | 연락처 |
| 장애유형 | 예: "지체장애 중증" (타입+중증/경증 결합) |
| 계약만료 | 계약 만료일 |
| 상태 | 근무중 / 결근 / 퇴사 |
| 관리 | "상세보기" 버튼 → `/company/employees/:id` |

#### 근로자 추가 모달

**섹션 1: 기본 인적 정보**
| 필드 | 타입 | 필수 | 설명 |
|------|------|------|------|
| 이름 | 텍스트 | O | 근로자 이름 |
| 주민등록번호 | 텍스트 | O | 000000-0000000 형식 |
| 성별 | 버튼 선택 | O | 남 / 여 |
| 휴대폰 번호 | 전화번호 | O | 010-0000-0000 형식 |

**섹션 2: 비상 연락처 정보**
| 필드 | 타입 | 필수 | 설명 |
|------|------|------|------|
| 비상 연락처 이름 | 텍스트 | O | 보호자/비상연락 대상자 |
| 근로자와의 관계 | 텍스트 | O | 부모, 보호자 등 |
| 비상 연락처 전화번호 | 전화번호 | O | 010-0000-0000 형식 |

**섹션 3: 장애 정보**
| 필드 | 타입 | 필수 | 설명 |
|------|------|------|------|
| 장애 유형 | 드롭다운 | O | 15개 유형 중 선택 |
| 중증/경증 | 버튼 선택 | O | 중증 (빨강) / 경증 (파랑) |

**장애 유형 목록**:
- 지체장애, 뇌병변장애, 시각장애, 청각장애, 언어장애
- 지적장애, 정신장애, 자폐성장애, 신장장애, 심장장애
- 호흡기장애, 간장애, 안면장애, 장루·요루장애, 간질장애

**섹션 4: 근무 및 인정 정보**
| 필드 | 타입 | 필수 | 설명 |
|------|------|------|------|
| 입사일 | 날짜 | O | 근무 시작일 |
| 장애인 인정일 | 날짜 | O | 장애인 고용 인정 시작일 |
| 근무 요일 | 다중 선택 | O | 월~일 중 선택 |
| 출근 시간 | 시간 | O | 예: 09:00 |

**섹션 5: 근로자 고유 번호 설정**
| 필드 | 타입 | 필수 | 설명 |
|------|------|------|------|
| 근로자 고유 번호 | 텍스트 | O | 출퇴근 앱 로그인용 코드 |

---

### 2-1. 근로자 상세 페이지 (`/company/employees/:id`)

**목적**: 개별 근로자의 상세 정보 조회 및 편집
**API 연동**: ✅ 완료 (`GET /v1/employees/:id`, `PATCH /v1/employees/:id`, `GET /v1/attendances`, `PATCH /v1/attendances/:id`)

#### 레이아웃

3열 그리드 (모바일에서 1열):
- **왼쪽 (1/3)**: 기본 정보, 고유번호, 장애 정보, 비고란
- **오른쪽 (2/3)**: 출퇴근 기록, 근무 정보, 문서 관리

#### 왼쪽: 기본 정보

**프로필 카드**
- 이니셜 아바타 (이름 첫 글자)
- 이름, 상태 배지 (근무중/퇴근/결근/퇴사)
- 핸드폰번호, 입사일, 계약 만료일

**근로자 고유번호 카드**
- 주황색 강조 카드로 고유번호 표시

**장애 정보 (편집 가능)**
- 유형 (읽기 전용), 중증/경증 (수정 가능), 인정일 (수정 가능)
- 수정 버튼 클릭 시 인라인 편집 모드
- API: `PATCH /v1/employees/:id` (`disabilitySeverity`, `disabilityRecognitionDate`)

**비고란 (편집 가능)**
- 회사 메모 텍스트
- 수정 버튼 클릭 시 textarea로 전환
- API: `PATCH /v1/employees/:id` (`companyNote`)

**퇴사 등록/퇴사 정보**
- 활성 근로자: "퇴사 등록" 버튼 (퇴사일, 사유 입력 모달)
- 퇴사자: 퇴사일, 비고 표시

#### 오른쪽: 상세 정보

**최근 출퇴근 기록**
- 최근 7건 조회 (`GET /v1/attendances?employeeId=...&limit=7`)
- 테이블 컬럼: 날짜, 출근, 퇴근, 상태(정상/지각/결근), 업무내용, 수정
- 업무내용: "확인하기" 링크 → 모달로 전체 내용 표시
- 수정: 각 행에 수정 아이콘 → 근무시간 수정 모달
  - 출근시간, 퇴근시간, 업무내용 편집
  - API: `PATCH /v1/attendances/:id` (`clockIn`, `clockOut`, `workContent`)

**근무 정보 (편집 가능)**
- 근무 요일: 월~일 토글 버튼 (선택된 요일 주황색 표시)
- 출근 시간: HH:MM 표시
- 수정 모드: 요일 토글 + time input
- API: `PATCH /v1/employees/:id` (`workDays`, `workStartTime`)

**문서 관리** (API 연동 완료)
- 문서 목록: 문서종류 배지, 파일명, 크기, 업로드일 표시
- 파일 클릭 시 새 탭에서 미리보기/다운로드
- 삭제 버튼 (확인 후 Supabase Storage + DB 삭제)
- 빈 상태 / 로딩 상태 UI
- 파일 업로드 모달: 문서 종류 선택 (근로계약서, 동의서, 건강검진, 자격증, 장애인등록증, 이력서, 기타) + 파일 선택 (PDF, JPG, PNG, 최대 10MB)
- API: `GET/POST /v1/employees/:id/files`, `DELETE /v1/employees/:id/files/:fileId`
- Supabase Storage 버킷: `employee-files`

---

### 3. 근무일정관리 탭

**목적**: 캘린더에서 날짜별 근무 내용 등록 (직원 앱에서 출근 시 표시)

#### 캘린더 뷰
- 월별 네비게이션 (이전/다음 월)
- 7열 그리드 (일~토)
- 요일 헤더 (일요일 빨강, 토요일 파랑)

#### 날짜 셀
- 날짜 숫자
- 등록된 일정 있는 경우:
  - 업무 내용 미리보기 (텍스트 truncate)
  - 파란 계열 배경
- 일정 없는 평일: + 아이콘
- 오늘 날짜: 주황색 테두리

#### 일정 등록 모달
- 날짜 클릭 시 모달 표시
- 선택한 날짜 표시
- 근무 내용 텍스트 영역 (8줄)
- 취소 / 저장 버튼

#### 일정 요약 카드
| 카드 | 아이콘 | 데이터 |
|------|--------|--------|
| 이번 달 등록 일정 | FileText | {개수}개 |

---

### 4. 공지사항 탭

**목적**: 근로자에게 긴급 공지 발송 및 발송 기록 관리

#### 새 공지사항 발송 섹션

**발송 대상 근로자**:
- "전체 선택" / "전체 해제" 버튼
- 검색창 (이름, 전화번호, 장애유형)
- 근로자 체크박스 목록
  - 아바타, 이름, 장애유형, 전화번호, 상태
- 선택된 근로자 수 표시

**공지사항 내용**:
- 텍스트 영역 (6줄)
- 플레이스홀더 예시:
  ```
  근로자들에게 전달할 공지사항을 작성해주세요.

  예)
  내일 오전 안전교육이 진행됩니다.
  필히 참석 부탁드립니다.
  ```

**버튼**:
- "초기화" - 선택 및 내용 초기화
- "발송하기" - 대상 선택 + 내용 입력 시 활성화

#### 발송 기록 섹션

**목록 표시**:
- 발송 날짜/시간 (예: "2026-01-28 14:30")
- 발송자
- 발송 대상 근로자 목록 (3명 초과 시 "+N명 더보기")
- 공지 내용

---

## 데이터 흐름

### 입력 데이터
| 항목 | 출처 | 설명 |
|------|------|------|
| 근로자 정보 | 모달 입력 | 신규 근로자 등록 |
| 근무 일정 | 캘린더 모달 | 날짜별 작업 내용 |
| 공지사항 | 텍스트 입력 | 발송할 공지 내용 |

### 출력 데이터
| 항목 | 대상 | 설명 |
|------|------|------|
| 오늘의 작업 내용 | 직원 앱 출근 화면 | 해당 날짜 근무 내용 |
| 긴급 공지 | 직원 앱 메인 화면 | 발송된 공지 표시 |
| 출퇴근 기록 | 대시보드 | 근로자별 출퇴근 현황 |

---

## API 연동 현황

| 기능 | API | 상태 |
|------|-----|------|
| 근로자 목록 조회 | `GET /v1/employees` | ✅ 완료 |
| 근로자 상세 조회 | `GET /v1/employees/:id` | ✅ 완료 |
| 근로자 정보 수정 | `PATCH /v1/employees/:id` | ✅ 완료 |
| 출퇴근 기록 조회 | `GET /v1/attendances` | ✅ 완료 |
| 출퇴근 기록 수정 | `PATCH /v1/attendances/:id` | ✅ 완료 |
| 대시보드 통계 | - | 📋 더미 데이터 |
| 근로자 등록 | `POST /v1/employees` | 📋 미연동 |
| 근무일정 관리 | - | 📋 더미 데이터 |
| 공지사항 발송 | - | 📋 더미 데이터 |

## 주요 타입

### CompanyEmployee

```typescript
interface CompanyEmployee {
  id: string;                          // UUID
  name: string;
  phone: string;
  disability: string | null;           // "지체장애 중증" (타입+중증/경증 결합)
  hireDate: string;                    // "YYYY-MM-DD"
  contractEndDate: string | null;
  status: 'checkin' | 'checkout' | 'absent' | 'resigned';  // 실시간 추론
  checkinTime: string | null;          // "HH:mm" (KST)
  checkoutTime: string | null;         // "HH:mm" (KST)
  uniqueCode: string;
  companyNote: string | null;
  isActive: boolean;
  resignDate: string | null;
  resignReason: string | null;
  workDays: number[];                  // [1,2,3,4,5] (1=월 ~ 7=일)
  workStartTime: string | null;        // "HH:mm"
  disabilityType: string | null;
  disabilitySeverity: string | null;   // "중증" | "경증"
  disabilityRecognitionDate: string | null; // "YYYY-MM-DD"
}
```

---

## 연관 기능

- 직원 대시보드 > 출근 화면: 오늘의 작업 내용 표시
- 직원 대시보드 > 메인 화면: 긴급 공지 표시
- 관리자 대시보드 > 출퇴근 현황: 전체 회사 데이터 조회
