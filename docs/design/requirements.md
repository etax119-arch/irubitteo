# 요구사항 정의서

## 1. 플랫폼 구조

### 3단계 멀티테넌트 구조

```
두르비터 관리자 (1명)
    └── 기업 A
    │       ├── 근로자 1
    │       ├── 근로자 2
    │       └── 근로자 3
    └── 기업 B
            ├── 근로자 4
            └── 근로자 5
```

### 사용자 역할

| 역할 | 권한 |
|------|------|
| 두르비터 관리자 | 플랫폼 전체 관리, 기업 계정 생성/관리 |
| 기업 | 소속 근로자 관리, 출퇴근 현황 조회 |
| 근로자 | 본인 출퇴근 기록, 업무 내용 입력 |

---

## 2. 사용자별 흐름

### 근로자 흐름
1. 고유번호로 로그인
2. 출근 버튼 클릭 → 시간 기록
3. 업무 내용 입력 (선택)
4. 퇴근 버튼 클릭 → 시간 기록
5. 본인 출퇴근 이력 조회

### 기업 흐름
1. 고유번호로 로그인
2. 근로자 목록 관리 (등록/수정/삭제)
3. 근로자 출퇴근 현황 조회
4. 결근자 확인

### 두르비터 관리자 흐름
1. 이메일/비밀번호로 로그인
2. 기업 계정 생성/관리
3. 전체 플랫폼 통계 조회
4. 시스템 설정 관리

---

## 3. 인증 방식

> 상세 구현은 [인증 시스템 문서](auth/README.md) 참조

### 직원 로그인
- **로그인 ID**: 생년월일 4자리 + 전화번호 뒤 4자리 (8자리)
  - 예: `99011234` (1999년 1월생, 전화번호 끝 1234)
- 기업이 근로자 등록 시 자동 생성
- 비밀번호 없음

### 기업 로그인
- **로그인 ID**: 제한 없음 (관리자가 자유롭게 설정)
- 비밀번호 없음

### 두르비터 관리자 로그인
- 이메일 + 비밀번호 방식
- 비밀번호 해싱 (bcrypt)
- 회원가입 기능 없음 (초기 계정 1개, 추후 추가 가능)
- 비밀번호 변경 가능

### 두르빗 대시보드
- 단일 인스턴스
- 관리자 계정이 여러 개여도 동일한 대시보드 공유

---

## 4. 근로자 정보 필드

| 필드 | 필수 | 설명 |
|------|------|------|
| 이름 | O | 실명 |
| 고유번호 | O | 로그인용 (자동 생성) |
| 연락처 | O | 휴대폰 번호 |
| 성별 | O | male / female |
| 주민등록번호 | O | 암호화 저장 |
| 입사일 | O | YYYY-MM-DD |
| 퇴사일 | X | 퇴사 시 입력 |
| 계약 만료일 | X | 계약직의 경우 |
| 출근 요일 | O | 기본 월~금 [1,2,3,4,5] |
| 근무 시작 시간 | O | 기본 09:00 |
| 근무 종료 시간 | O | 기본 18:00 |
| 프로필 사진 | X | 선택 |
| 첨부 파일 | X | 계약서 등 |
| 장애 유형 | X | 지체장애, 시각장애 등 |
| 장애 중증도 | X | severe (중증) / mild (경증) |
| 장애인 인정일 | X | YYYY-MM-DD |
| 비상연락처 이름 | X | 보호자/가족 이름 |
| 비상연락처 관계 | X | 부모, 배우자 등 |
| 비상연락처 전화번호 | X | 휴대폰 번호 |

---

## 5. 출퇴근 규칙

### 출근
- 출근 버튼 클릭 시 현재 시간 기록
- 하루에 1회만 출근 가능
- 지각 기준: 근무 시작 시간 이후 출근

### 퇴근
- 퇴근 버튼 클릭 시 현재 시간 기록
- 출근 기록이 있어야 퇴근 가능
- 조퇴 기준: 근무 종료 시간 이전 퇴근

### 결근 판단
- **자동 결근 처리**: 출근 요일에 출근 기록이 없으면 결근
- 기업이 근로자 등록 시 출근 요일 설정 (예: 월~금 [1,2,3,4,5])
- 설정된 출근 요일에만 결근 판단 적용 (근로자별로 다르게 설정 가능)
- 결근 판단 시점: 다음 날 자정 (배치 처리)

### 관리자/기업 수정
- 기업/관리자가 출퇴근 기록 수정 가능 (출퇴근 시간, 업무 내용)
- 수정 시 비고(note) 필드에 수정 사유 기록
- 수정 이력은 감사 로그에 자동 기록

---

## 6. 업무 내용

### 업무 기록 방식
- **퇴근 시 업무 요약 (work_content)**: 근로자가 퇴근할 때 하루 업무를 간단히 요약하여 입력
- 하루에 1건만 기록 (attendances 테이블의 work_content 필드)
- 퇴근 시 사진 첨부 가능 (photo_urls 필드)

### 근무일정 (schedules)
- **기업이 날짜별 근무내용 등록**: 기업이 근무일정관리탭에서 해당 날짜에 진행할 업무 내용을 미리 등록
- 근로자 출근 시 오늘의 근무일정 확인 가능
- schedules 테이블에서 관리 (기업별, 날짜별 1건)

---

## 7. 보안 정책

### 데이터 암호화
- 주민등록번호: AES-256 암호화 저장
- 관리자 비밀번호: bcrypt 해싱
- 전송 데이터: HTTPS 필수

### 접근 제어
- 근로자: 본인 데이터만 접근
- 기업: 소속 근로자 데이터만 접근
- 관리자: 전체 데이터 접근

### 감사 로그
- 로그인/로그아웃 기록
- 중요 데이터 변경 기록
- 90일 보관
